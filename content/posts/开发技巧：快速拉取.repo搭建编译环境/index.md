+++
date = '2025-07-28T22:28:30+08:00'
draft = false
title = '开发技巧：快速拉取.repo搭建编译环境'
tags = ['AOSP', '编译','调试技巧']
summary= "开发技巧：快速拉取.repo搭建编译环境"

+++



> 从网络上拉取代码，容易受当时网络影响，对一些大仓库不一定能够拉取成功；因此可以通过拷贝现有.repo文件夹，来快速搭建编译环境

## 核心步骤
1. 原有编译环境
```
tar -cvf repo.tgz .repo
```

2. 将repo.tgz想办法拷贝到需要运行的工作站/服务器；

3. 解压repo.tgz
```
tar -xvf repo.tgz
```

4. repo sync

---
## 进一步改进

1. 方式1：将.repo每天定时更新、压缩并放到公共云盘，编译脚本通过公共云盘进行下载；
2. 方式2：搭建本地代理仓库，将里面的仓库改为本地代理仓库；

## 时间统计估算

> 不同环境网速不一样，这个是自己工作环境的速度

- 通过传统拉取编译代码方式，拉取整个仓库代码在大半天~几天不等，具体视网络情况而定
- 通过拷贝.repo，亲测时间如下：
    - repo.tgz打包，没有仔细估算，约15~25分钟
    - repo.tgz拷贝到本地，本地上传到Docker（30min + 30min，后续通过命令直接传输两个服务器的文件，可以减少为一次拷贝，估算30min）
    - Repo sync，估算约30min
    - 整个流程在1~2h内可以搭建一套最新的编译环境
